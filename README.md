# ğŸ‘ï¸ Sistema de GestÃ£o de Ã“ticas - Carne FÃ¡cil# ğŸ‘ï¸ Sistema de GestÃ£o de Ã“ticas - Carne FÃ¡cil



![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)

![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)

![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15+-blue.svg)![Status](https://img.shields.io/badge/Status-Operacional-brightgreen.svg)

![Status](https://img.shields.io/badge/Status-Enterprise--Ready-brightgreen.svg)![License](https://img.shields.io/badge/License-Private-red.svg)



## ğŸ¯ VisÃ£o Geral## ğŸ¯ VisÃ£o Geral



Sistema **enterprise** para gestÃ£o unificada de 6 Ã³ticas com processamento de planilhas Excel, banco de dados PostgreSQL profissional e interface web FastAPI.Sistema web avanÃ§ado para gestÃ£o unificada de Ã³ticas com processamento inteligente de planilhas Excel, normalizaÃ§Ã£o de dados, sistema de relacionamento Cliente-OS e controle completo de duplicaÃ§Ãµes.



## ğŸ—ï¸ Arquitetura### âœ¨ CaracterÃ­sticas Principais



```- ğŸŒ **Interface Web Moderna** - FastAPI + Jinja2

carne_facil/- ğŸ“Š **Dashboard Executivo** - MÃ©tricas em tempo real

â”œâ”€â”€ ğŸ“‚ app/                 # ğŸŒ AplicaÃ§Ã£o Web (FastAPI)- ğŸ”— **Sistema de Relacionamento** - Cliente-OS inteligente

â”œâ”€â”€ ğŸ“‚ database/            # ğŸ—„ï¸ Scripts SQL Enterprise- ğŸ‘ï¸ **DioptrÃ­as Completas** - 25+ campos de prescriÃ§Ã£o

â”œâ”€â”€ ğŸ“‚ etl/                 # ğŸ“¥ ImportaÃ§Ã£o de Dados (5 scripts)- ğŸ’° **GestÃ£o de Vendas** - Produtos, pagamentos e anÃ¡lises

â”œâ”€â”€ ğŸ“‚ scripts/             # ğŸ› ï¸ UtilitÃ¡rios (58 scripts organizados)- ğŸª **Multi-loja** - MAUA, SAO_MATEUS, RIO_PEQUENO

â”‚   â”œâ”€â”€ analise/           #    ğŸ“Š AnÃ¡lises (26)- ğŸ¤– **DeduplicaÃ§Ã£o Inteligente** - FuzzyWuzzy + Levenshtein

â”‚   â”œâ”€â”€ relatorios/        #    ğŸ“ˆ RelatÃ³rios (8)

â”‚   â”œâ”€â”€ processamento/     #    âš™ï¸ Processadores (17)## ğŸ“Š Resultados AlcanÃ§ados

â”‚   â”œâ”€â”€ limpeza/           #    ğŸ§¹ ManutenÃ§Ã£o (5)

â”‚   â””â”€â”€ deprecated/        #    ğŸ“¦ Legado (2)### ğŸ¯ Dados Processados

â”œâ”€â”€ ğŸ“‚ data/                # ğŸ“ Dados Excel- **ğŸ‘¥ 3,262** clientes Ãºnicos identificados

â””â”€â”€ ğŸ“‚ docs/                # ğŸ“š DocumentaÃ§Ã£o- **ğŸ“‹ 14,337** ordens de serviÃ§o processadas  

```- **ğŸ”— 5,624** relacionamentos OS-Cliente estabelecidos

- **ğŸ‘ï¸ 12,309** registros de dioptrÃ­as extraÃ­dos

## âœ¨ CaracterÃ­sticas Enterprise- **ğŸ’° R$ 70.2M** em vendas analisadas

- **ğŸ·ï¸ 373** produtos Ãºnicos catalogados

### ğŸ—„ï¸ Banco de Dados PostgreSQL

- âœ… **5 schemas** organizados (core, vendas, optica, marketing, auditoria)### ğŸ†• Sistema Universal de Vendas (NOVO!)

- âœ… **UUIDs** como chaves primÃ¡rias- **ğŸš€ Sistema Completo Implementado** - Processamento individual e em lote

- âœ… **Soft delete** (nunca perde dados)- **ğŸ“Š 264 vendas** processadas (MAUA: 60, SUZANO: 204)

- âœ… **Auditoria automÃ¡tica** (created_at, updated_at, version)- **ğŸ’° R$ 144.510,92** em faturamento consolidado

- âœ… **Busca fuzzy** com pg_trgm- **ğŸ“… Suporte 2024/2025** - Estrutura multi-anos

- âœ… **NormalizaÃ§Ã£o automÃ¡tica** de textos- **ğŸ”§ FormataÃ§Ã£o Brasileira** - Valores monetÃ¡rios corretos

- âœ… **ValidaÃ§Ã£o de CPF** via triggers- **ğŸ“ˆ RelatÃ³rios Executivos** - Dashboards e anÃ¡lises completas

- âœ… **25+ Ã­ndices otimizados**

### ğŸ“ˆ Performance do Sistema

### ğŸŒ Web App (FastAPI)- **âœ… 33.6%** taxa de identificaÃ§Ã£o Cliente-OS

- ğŸš€ Servidor rÃ¡pido e assÃ­ncrono- **âœ… 96.7%** OS com dados de vendas

- ğŸ“Š Dashboard com mÃ©tricas- **âœ… 83.0%** OS com produtos registrados

- ğŸ“¤ Upload de planilhas Excel- **âœ… 100%** automaÃ§Ã£o do processamento

- ğŸ” Busca inteligente de clientes

- ğŸ“ˆ RelatÃ³rios executivos## ğŸš€ InstalaÃ§Ã£o e ExecuÃ§Ã£o



### ğŸ“¥ ETL Robusto### PrÃ©-requisitos

- ğŸ“Š **20.175 registros** processados- Python 3.11+

- ğŸ’° **R$ 7.752.688,50** em valores- pip (gerenciador de pacotes Python)

- ğŸª **6 lojas** (5 ativas + 1 fechada)

- ğŸ”„ ImportaÃ§Ã£o automÃ¡tica### 1. Clone o RepositÃ³rio

```bash

## ğŸ“Š Dados Atuaisgit clone https://github.com/mellooticas/carne_facil.git

cd carne_facil

| Fonte | Registros | Valor |```

|-------|-----------|-------|

| **Vendas (VEND)** | 7.547 | R$ 6.032.727,49 |### 2. Crie o Ambiente Virtual

| **Recebimentos** | 3.108 | R$ 379.671,97 |```bash

| **Entregas OS** | 5.974 | - |python -m venv .venv

| **Entregas CarnÃª** | 678 | R$ 411.087,49 |```

| **Restantes** | 2.868 | R$ 929.201,55 |

| **TOTAL** | **20.175** | **R$ 7.752.688,50** |### 3. Ative o Ambiente Virtual

**Windows:**

## ğŸš€ Quick Start```bash

.venv\Scripts\activate

### 1. Clonar e Instalar```

```bash

git clone https://github.com/mellooticas/carne_facil.git**Linux/Mac:**

cd carne_facil```bash

python -m venv .venvsource .venv/bin/activate

source .venv/Scripts/activate  # Windows```

pip install -r requirements.txt

```### 4. Instale as DependÃªncias

```bash

### 2. Criar Banco de Dadospip install -r requirements.txt

```bash```

# Criar database PostgreSQL

createdb -U postgres oticas_db### 5. Execute o Sistema Principal

```bash

# Executar scripts SQL (em ordem)uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

psql -U postgres -d oticas_db -f database/01_inicial_config.sql```

psql -U postgres -d oticas_db -f database/02_schema_core.sql

```### 6. Execute o Dashboard (opcional)

```bash

### 3. Importar Dadospython dashboard_simples.py

```bash```

# Importar dados das planilhas Excel

python etl/importador_caixas_completo.py## ğŸŒ Acesso ao Sistema

python etl/padronizar_clientes_vixen.py

```- **Sistema Principal:** http://localhost:8000

- **Dashboard Executivo:** http://localhost:8002

### 4. Executar App Web- **Upload de Arquivos:** http://localhost:8000/upload

```bash

uvicorn app.main:app --reload## ğŸ“ Estrutura do Projeto

# Acesse: http://localhost:8000

``````

carne_facil/

## ğŸ“š DocumentaÃ§Ã£oâ”œâ”€â”€ app/                    # AplicaÃ§Ã£o web FastAPI

â”‚   â”œâ”€â”€ main.py            # Servidor principal

### Databaseâ”‚   â”œâ”€â”€ models/            # Modelos de dados

- ğŸ“– [README Completo](database/README.md) - Arquitetura completaâ”‚   â”œâ”€â”€ services/          # ServiÃ§os de negÃ³cio

- ğŸ—ºï¸ [Diagrama ERD](database/ERD_DIAGRAMA.md) - Mermaid visualâ”‚   â””â”€â”€ templates/         # Templates HTML

- ğŸ“„ [Resumo Executivo](database/RESUMO_EXECUTIVO.md) - VisÃ£o geralâ”œâ”€â”€ scripts/               # Scripts de processamento

â”‚   â”œâ”€â”€ analisar_estrutura_os.py

### Scriptsâ”‚   â”œâ”€â”€ criar_sistema_id_cliente.py

- ğŸ“¥ [ETL](etl/README.md) - ImportaÃ§Ã£o de dadosâ”‚   â”œâ”€â”€ extrair_dioptrias.py

- ğŸ“Š [AnÃ¡lises](scripts/analise/README.md) - 26 scriptsâ”‚   â”œâ”€â”€ extrair_vendas.py

- ğŸ“ˆ [RelatÃ³rios](scripts/relatorios/README.md) - 8 geradoresâ”‚   â”œâ”€â”€ criar_relacionamento_os_cliente.py

- âš™ï¸ [Processamento](scripts/processamento/README.md) - 17 scriptsâ”‚   â””â”€â”€ sistema_final_integrado.py

- ğŸ§¹ [Limpeza](scripts/limpeza/README.md) - 5 utilitÃ¡riosâ”œâ”€â”€ data/                  # Dados do sistema

â”‚   â”œâ”€â”€ raw/              # Dados brutos

## ğŸ¯ Uso Comumâ”‚   â””â”€â”€ processed/        # Dados processados

â”œâ”€â”€ dashboard_simples.py   # Dashboard executivo

### Importar novos dadosâ””â”€â”€ requirements.txt       # DependÃªncias

```bash```

python etl/importador_caixas_completo.py

```## ğŸ”§ Scripts DisponÃ­veis



### Gerar relatÃ³rio executivo### ğŸ“Š AnÃ¡lise e Processamento

```bash```bash

python scripts/relatorios/relatorio_executivo_final.py# Analisar estrutura das OS

```python scripts/analisar_estrutura_os.py



### Analisar dados# Criar sistema de ID Ãºnico para clientes

```bashpython scripts/criar_sistema_id_cliente.py

python scripts/analise/analisar_dados_reais.py

```# Extrair dados de dioptrÃ­as

python scripts/extrair_dioptrias.py

### Iniciar servidor web

```bash# Extrair dados de vendas

uvicorn app.main:app --reloadpython scripts/extrair_vendas.py

```

# Criar relacionamentos OS-Cliente

## ğŸª Lojas Gerenciadaspython scripts/criar_relacionamento_os_cliente.py



| Loja | CÃ³digo | Status | Cidade |# Gerar sistema final integrado

|------|--------|--------|--------|python scripts/sistema_final_integrado.py

| MauÃ¡ | MAUA | âœ… Ativa | MauÃ¡ |```

| Suzano | SUZANO | âœ… Ativa | Suzano |

| Suzano 2 | SUZANO2 | âœ… Ativa | Suzano |## ğŸ¯ Funcionalidades Implementadas

| Rio Pequeno | RIO_PEQUENO | âœ… Ativa | SÃ£o Paulo |

| Perus | PERUS | âœ… Ativa | SÃ£o Paulo |### âœ… Sistema Base

| SÃ£o Mateus | SAO_MATEUS | âŒ Fechada | SÃ£o Paulo |- [x] Interface web operacional

- [x] Upload de arquivos Excel

## ğŸ› ï¸ Stack TecnolÃ³gica- [x] Processamento de mÃºltiplos formatos

- [x] Sistema de logs detalhado

- **Backend**: Python 3.11+, FastAPI

- **Database**: PostgreSQL 15+### âœ… Processamento de Dados

- **Data Processing**: Pandas, Openpyxl- [x] NormalizaÃ§Ã£o automÃ¡tica

- **Fuzzy Search**: FuzzyWuzzy, Python-Levenshtein- [x] DeduplicaÃ§Ã£o inteligente

- **Frontend**: Jinja2, HTML/CSS- [x] Mapeamento de 82 campos Ãºnicos

- **Analysis**: Jupyter Notebooks- [x] IdentificaÃ§Ã£o de 3 lojas ativas



## ğŸ“ˆ MÃ©tricas do Projeto### âœ… Sistema de Relacionamento

- [x] IDs Ãºnicos para clientes (CLI_000001)

- **Scripts Python**: 63 organizados- [x] Fuzzy matching para nomes

- **Schemas SQL**: 5 (core, vendas, optica, marketing, auditoria)- [x] Busca por CPF com prioridade

- **Tabelas**: 13 principais- [x] Taxa de identificaÃ§Ã£o de 33.6%

- **FunÃ§Ãµes**: 8 utilitÃ¡rias

- **Ãndices**: 25+ otimizados### âœ… DioptrÃ­as Completas

- **Triggers**: 5 automÃ¡ticos- [x] 25 campos de prescriÃ§Ã£o

- **Dados**: 20.175 registros- [x] Olho direito (OD) e esquerdo (OE)

- **Valor Total**: R$ 7.75M- [x] ESF, CIL, EIXO, DNP, ALTURA

- [x] ADIÃ‡ÃƒO para multifocais

## ğŸ¤ Contribuindo

### âœ… GestÃ£o de Vendas

Este Ã© um projeto privado para uso interno da rede de Ã³ticas.- [x] 5 produtos por OS

- [x] CÃ³digos Trello

## ğŸ“ Suporte- [x] Formas de pagamento

- [x] Sinais e valores restantes

Para dÃºvidas sobre o sistema:

- ğŸ“§ Email: suporte@sistema-oticas.com### âœ… Dashboard Executivo

- ğŸ“š Docs: Ver pasta `/docs/`- [x] MÃ©tricas em tempo real

- ğŸ—ºï¸ ERD: `/database/ERD_DIAGRAMA.md`- [x] AnÃ¡lise por loja

- [x] Interface responsiva

## ğŸ“„ LicenÃ§a- [x] Auto-refresh



Private - Uso interno apenas## ğŸ“‹ Dados Suportados



---### ğŸª Lojas Operacionais

- **MAUA** - 5,252 registros

**VersÃ£o**: 2.0.0 (Enterprise)  - **SAO_MATEUS** - MÃºltiplos arquivos

**Ãšltima atualizaÃ§Ã£o**: 10/10/2025  - **RIO_PEQUENO** - 552 registros

**Status**: âœ… ProduÃ§Ã£o

### âš™ï¸ Sistemas Integrados
- **LANCASTER** - Sistema principal
- **OTM** - Sistema complementar

### ğŸ“Š Campos de DioptrÃ­as
```
PONTE, HORIZONTAL, DIAG_MAIOR, VERTICAL
ESF_OD, CIL_OD, EIXO_OD, DNP_OD, ALTURA_OD
ESF_OE, CIL_OE, EIXO_OE, DNP_OE, ALTURA_OE
ADICAO_OD, ADICAO_OE
AR_LONGE, AR_PERTO, MULTIFOCAL
```

### ğŸ’° Campos de Vendas
```
Cod_trello
Produto_1-5: codigo, descricao, valor
Valor_total, Pagto_1/2, Sinal_1/2, Valor_resta
```

## ğŸ› ï¸ Tecnologias Utilizadas

- **Backend:** FastAPI, Uvicorn
- **Dados:** Pandas, Openpyxl, SQLAlchemy
- **DeduplicaÃ§Ã£o:** FuzzyWuzzy, Python-Levenshtein
- **Frontend:** Jinja2, Bootstrap 5, Font Awesome
- **GrÃ¡ficos:** Plotly.js (dashboard avanÃ§ado)
- **AnÃ¡lise:** Jupyter Notebooks

## ğŸ“ˆ PrÃ³ximos Passos

1. **PadronizaÃ§Ã£o de Dados** - Template Excel unificado
2. **ExpansÃ£o de Lojas** - IntegraÃ§Ã£o das 6 lojas
3. **API REST** - Endpoints para integraÃ§Ã£o
4. **RelatÃ³rios AvanÃ§ados** - PDFs automatizados
5. **Mobile App** - Interface mobile nativa

## ğŸ¤ ContribuiÃ§Ã£o

Este Ã© um projeto privado para gestÃ£o de Ã³ticas. Para contribuiÃ§Ãµes, entre em contato com a equipe de desenvolvimento.

## ğŸ“ Suporte

Para dÃºvidas ou suporte tÃ©cnico:
- ğŸ“§ Email: suporte@carnefacil.com.br
- ğŸ¢ Sistema: Ã“ticas Carne FÃ¡cil

---

### ğŸ† Conquistas do Sistema

âœ… **Clientes Consolidados** - Base Ãºnica e limpa  
âœ… **Relacionamento OS-Cliente** - Sistema inteligente  
âœ… **DioptrÃ­as Completas** - 25+ campos extraÃ­dos  
âœ… **Vendas Integradas** - R$ 70.2M processados  
âœ… **Dashboard Executivo** - VisÃ£o estratÃ©gica  
âœ… **Multi-loja** - 3 lojas operacionais  

---

**Desenvolvido com â¤ï¸ para Ã“ticas Carne FÃ¡cil**